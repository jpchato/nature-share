{% extends 'base.html' %}
{% block content %}
{% load static %}

<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vue@2.6.12/dist/vue.js"></script>


<link rel="stylesheet" type="text/css" href="{% static 'natureShareApp/organism_detail.css' %}">
<div id = 'app'>
    <h1>{{ organism.name }}</h1>
    <img src="{{ organism.picture.url }}" /> 
    <p>edible: {{ organism.edibility }}</p>
    <p>ecosystem: {{ organism.ecosystem }}</p>
    <p>[[ ecosystem_summary ]]</p>
    <p>weather: {{ organism.weather }}</p>
    <!-- <p>[[ weather_summary ]]</p> -->
    <p>date: {{ organism.date }}</p>
</div>


<script> 
    organismEcosystem = '{{organism.ecosystem}}'
    console.log(organismEcosystem)
    var app = new Vue({
        delimiters: ['[[', ']]'],
        el: '#app',
        data: {
            ecosystem_summary: '',
            weather_summary: '',
            
        },
        mounted:  async function(event){
            
            if (organismEcosystem != 'None' && organismEcosystem != 'Unknown' && organismEcosystem != 'Other'){
                let response = await axios.get('https://en.wikipedia.org/api/rest_v1/page/summary/{{organism.ecosystem}}');
                this.ecosystem_summary = response.data.extract;
            }

            let weather_response = await axios.get('https://en.wikipedia.org/api/rest_v1/page/summary/{{organism.weather}}');
            this.weather_summary = weather_response.data.extract;

        },
       
    })
        
    </script>
{% endblock %}